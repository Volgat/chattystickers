<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ChattyStickers â€” AI Animated & Talking Stickers</title>
  <meta name="description"
    content="Generate animated and talking stickers with AI. Export to GIF, WebP, or WebM for WhatsApp, Telegram, and Discord." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="/style.css" />
</head>

<body>

  <!-- Background particles -->
  <div class="bg-particles" id="bgParticles"></div>

  <!-- Header -->
  <header class="header">
    <div class="header-inner">
      <div class="logo">
        <span class="logo-icon">ğŸ’¬âœ¨</span>
        <span class="logo-text">Chatty<span class="accent">Stickers</span></span>
      </div>
      <div class="header-badge">
        <span class="badge-dot"></span>
        <span>AI Quality Guard Active</span>
      </div>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero">
    <div class="hero-content">
      <div class="hero-tag">ğŸ‰ New â€” Talking AI Stickers</div>
      <h1 class="hero-title">
        Turn your<br />
        <span class="gradient-text">phrases into stickers</span><br />
        animated and talking
      </h1>
      <p class="hero-sub">
        Type a phrase, AI generates a sticker with image, voice and animation.<br />
        Export to GIF, WebP or WebM for WhatsApp, Telegram & Discord.
      </p>
    </div>
  </section>

  <!-- Main App -->
  <main class="app-container">

    <!-- Input Card -->
    <div class="card input-card">
      <div class="card-header">
        <div class="step-badge">Step 1</div>
        <h2>Describe & Personalize</h2>
        <p class="card-sub">Choose AI generation or use your own avatar photo</p>
      </div>

      <div class="input-mode-tabs">
        <button class="tab-btn active" id="tab-ai" onclick="setMode('ai')">ğŸ¤– AI Generation</button>
        <button class="tab-btn" id="tab-upload" onclick="setMode('upload')">ğŸ“¸ Custom Photo</button>
      </div>

      <div id="aiModeArea">
        <div class="input-wrapper">
          <textarea id="phraseInput" class="phrase-input" placeholder="Ex: My cat says &#39;Hello !&#39; while dancing"
            rows="3" maxlength="300"></textarea>
          <div class="input-meta">
            <div class="example-chips">
              <span class="chip-label">Examples:</span>
              <button class="chip" onclick="setExample(this)">ğŸ± My cat says 'Hello !' while dancing</button>
              <button class="chip" onclick="setExample(this)">ğŸ¶ My dog sings 'I love you'</button>
              <button class="chip" onclick="setExample(this)">ğŸ¤– The robot says 'Hello human!'</button>
              <button class="chip" onclick="setExample(this)">ğŸ» The bear is sad and crying</button>
            </div>
            <span class="char-count" id="charCount">0 / 300</span>
          </div>
        </div>
      </div>

      <div id="uploadModeArea" style="display:none">
        <div class="upload-zone" id="uploadZone" onclick="document.getElementById('fileInput').click()">
          <div class="upload-icon">ğŸ“</div>
          <div class="upload-text">
            <strong>Click to upload</strong> or drag and drop<br />
            <span>(JPG, PNG or WEBP Â· 512x512 recommended)</span>
          </div>
          <input type="file" id="fileInput" accept="image/*" style="display:none" onchange="handleFileSelect(event)">
          <div id="uploadPreview" class="upload-preview-container" style="display:none">
            <img id="imagePreview" src="" alt="Avatar preview">
            <button class="remove-upload" onclick="removeUpload(event)">âœ•</button>
          </div>
        </div>
        <div class="input-wrapper" style="margin-top:20px">
          <textarea id="phraseInputUpload" class="phrase-input"
            placeholder="What should your avatar say? (Ex: 'Happy Birthday!')" rows="2" maxlength="200"></textarea>
        </div>
      </div>

      <button class="btn-generate" id="generateBtn" onclick="generateSticker()">
        <span class="btn-icon">âœ¨</span>
        <span class="btn-text">Generate Talking Sticker</span>
        <span class="btn-arrow">â†’</span>
      </button>
    </div>

    <!-- Progress Indicator -->
    <div class="progress-card card" id="progressCard" style="display:none">
      <div class="progress-header">
        <div class="spinner"></div>
        <span id="progressLabel">Initializing...</span>
      </div>
      <div class="progress-bar-wrapper">
        <div class="progress-bar" id="progressBar"></div>
      </div>
      <div class="pipeline-steps" id="pipelineSteps">
        <div class="step-item" id="step-parse">ğŸ§  Text analysis</div>
        <div class="step-item" id="step-image">ğŸ¨ AI Image generation</div>
        <div class="step-item" id="step-tts">ğŸ”Š Voice synthesis</div>
        <div class="step-item" id="step-anim">ğŸ¬ Sticker animation</div>
        <div class="step-item" id="step-earcp">ğŸ›¡ï¸ Quality check</div>
        <div class="step-item" id="step-export">ğŸ“¦ Multi-format export</div>
      </div>
    </div>

    <!-- Result Section -->
    <div id="resultSection" style="display:none">

      <!-- Preview Card -->
      <div class="card preview-card">
        <div class="card-header">
          <div class="step-badge success">Result</div>
          <h2>Your Animated Sticker</h2>
        </div>

        <div class="preview-grid">
          <!-- PRIMARY: Unified Talking Sticker (MP4 with audio) -->
          <div class="preview-main">
            <div class="preview-frame">
              <!-- Video sticker: animation + voice in one file -->
              <video id="stickerVideo" class="sticker-preview" autoplay loop muted playsinline
                style="display:none"></video>
              <!-- Fallback GIF if video unavailable -->
              <img id="gifFallback" class="sticker-preview" src="" alt="Animated sticker" style="display:none" />
              <div class="preview-overlay" id="previewBadge">
                <span id="previewLabel">ğŸ¬ğŸ”Š Multimedia Sticker</span>
              </div>
            </div>
            <!-- Audio controls for the talking sticker -->
            <div class="sticker-audio-bar" id="stickerAudioBar" style="display:none">
              <button class="audio-toggle-btn" id="audioToggleBtn" onclick="toggleStickerAudio()">
                <span id="audioToggleIcon">ğŸ”Š</span>
                <span id="audioToggleText">Sound ON</span>
              </button>
              <div class="audio-mini-wave">
                <div class="wave-bar"></div>
                <div class="wave-bar"></div>
                <div class="wave-bar"></div>
                <div class="wave-bar"></div>
                <div class="wave-bar"></div>
              </div>
              <span class="sticker-format-badge">WebM â€¢ Animation + Voix</span>
            </div>
            <div class="parsed-info" id="parsedInfo"></div>
          </div>

          <!-- Side Panel: Image + Info -->
          <div class="preview-side">
            <!-- Static Source Image -->
            <div class="side-preview-box">
              <div class="side-label">ğŸ¨ Source image (AI)</div>
              <img id="staticPreview" class="side-preview-img" src="" alt="Sticker image" />
            </div>
            <!-- Sticker info -->
            <div class="side-preview-box" id="stickerInfoBox">
              <div class="side-label">ğŸ“¦ Final file</div>
              <div class="sticker-file-info" id="stickerFileInfo">
                <!-- Filled by JS -->
              </div>
            </div>
          </div>
        </div>

      </div>

      <!-- EARCP Score Card -->
      <div class="card earcp-card">
        <div class="card-header">
          <div class="step-badge earcp">EARCP</div>
          <h2>Quality & Coherence Score</h2>
          <p class="card-sub">Multi-signal verification by the EARCP algorithm</p>
        </div>

        <div class="earcp-content" id="earcpContent">
          <!-- Filled by JS -->
        </div>
      </div>

      <!-- Export Card -->
      <div class="card export-card">
        <div class="card-header">
          <div class="step-badge export">Export</div>
          <h2>Download your Sticker</h2>
          <p class="card-sub">Formats compatible with WhatsApp, Telegram & Discord</p>
        </div>

        <div class="export-grid" id="exportGrid">
          <!-- Filled by JS -->
        </div>
      </div>

    </div>

    <!-- Error Card -->
    <div class="card error-card" id="errorCard" style="display:none">
      <div class="error-icon">âš ï¸</div>
      <h3 id="errorTitle">An error occurred</h3>
      <p id="errorMessage"></p>
      <button class="btn-retry" onclick="resetUI()">Retry</button>
    </div>

    <!-- How it Works -->
    <section class="how-it-works">
      <h2 class="section-title">How it works?</h2>
      <div class="steps-grid">
        <div class="step-card">
          <div class="step-num">1</div>
          <div class="step-icon">âœï¸</div>
          <h3>Write a phrase</h3>
          <p>Describe your character and what they are doing or saying.</p>
        </div>
        <div class="step-card">
          <div class="step-num">2</div>
          <div class="step-icon">ğŸ¨</div>
          <h3>AI Image</h3>
          <p>Advanced neural models generate a matching cartoon sticker.</p>
        </div>
        <div class="step-card">
          <div class="step-num">3</div>
          <div class="step-icon">ğŸ”Š</div>
          <h3>TTS Voice</h3>
          <p>A natural voice reads your text in French or English.</p>
        </div>
        <div class="step-card">
          <div class="step-num">4</div>
          <div class="step-icon">ğŸ¬</div>
          <h3>Animation</h3>
          <p>The character moves, dances or speaks according to the detected emotion.</p>
        </div>
        <div class="step-card">
          <div class="step-num">5</div>
          <div class="step-icon">ğŸ›¡ï¸</div>
          <h3>Quality Control</h3>
          <p>Our AI system evaluates sticker coherence and quality for the best result.</p>
        </div>
        <div class="step-card">
          <div class="step-num">6</div>
          <div class="step-icon">ğŸ“¤</div>
          <h3>Export & Share</h3>
          <p>Download in GIF, WebP or WebM and send everywhere.</p>
        </div>
      </div>
    </section>

  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-inner">
      <div class="footer-logo">ğŸ’¬âœ¨ ChattyStickers</div>
      <div class="footer-text">
        Powered by Advanced AI Â·
        Stable Diffusion Â· TTS Â· Python
      </div>
      <div class="footer-text">Â© 2025 Mike Amega â€” All rights reserved</div>
    </div>
  </footer>

  <script src="/app.js"></script>
</body>

</html>